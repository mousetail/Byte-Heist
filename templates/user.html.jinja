{% extends "base/base.html.jinja" %}
{% import "base/test_cases.html.jinja" as test_cases %}
{% block content %}
  <div class="flex min-h-screen flex-col bg-byte-brown-950">
    <main class="flex-1">
      <div class="max-w-8xl mx-auto py-8 px-4 sm:px-6 md:px-8 lg:px-28 mt-10">
        <div class="flex flex-col gap-6">
          <!-- Profile Header -->
          <div class="border border-byte-brown-500 bg-byte-brown-700 rounded-lg">
            <div class="p-6">
              <div class="flex flex-col md:flex-row gap-6 items-start">
                <div class="flex flex-col items-center gap-4">
                  <div class="h-24 w-24 border-4 border-green-500 rounded-full overflow-hidden bg-byte-brown-500 flex items-center justify-center">
                    <img src="{{ object.account_info.avatar }}&size=96"
                         alt="{{ object.account_info.username }}"
                         class="w-full h-full object-cover" />
                  </div>
                </div>
                <div class="flex-1 space-y-4">
                  <div>
                    <h1 class="text-3xl font-bold text-white">{{ object.account_info.username }}</h1>
                    <p class="text-byte-brown-200">Joined {{ object.account_info.join_date | format_date(include_day=false) }}</p>
                  </div>
                  <div class="flex flex-wrap gap-2">
                    <span class="bg-byte-brown-500 text-white border border-byte-brown-200 text-xs px-2 py-1 rounded flex items-center gap-1">
                      <svg viewBox="0 0 24 24"
                           fill="none"
                           xmlns="http://www.w3.org/2000/svg"
                           id="Cup-First--Streamline-Solar"
                           height="16"
                           width="16">
                        <path d="m18.33325 6.801950000000001 0 0.060441666666666664c0 0.7172833333333333 0 1.075925 -0.17266666666666666 1.3693583333333335 -0.17266666666666666 0.2934166666666667 -0.4861666666666667 0.4675833333333334 -1.1131666666666669 0.8159166666666666l-0.6610833333333334 0.36733333333333335c0.4555 -1.5401333333333334 0.6075 -3.1948833333333333 0.6637500000000001 -4.610025 0.0023333333333333335 -0.060675 0.005083333333333334 -0.12210000000000001 0.007833333333333335 -0.18416666666666667l0.0019166666666666668 -0.04348333333333333c0.5427500000000001 0.188475 0.8474166666666666 0.3289916666666667 1.0375 0.5927416666666667 0.23600000000000002 0.3273666666666667 0.23600000000000002 0.7622083333333334 0.2359166666666667 1.6318833333333334Z" fill="currentColor" stroke-width="0.8333">
                        </path>
                        <path d="m1.6666666666666667 6.801950000000001 0 0.060441666666666664c0.000025 0.7172833333333333 0.00003333333333333333 1.075925 0.17269166666666666 1.3693583333333335 0.17265833333333336 0.2934166666666667 0.4861666666666667 0.4675833333333334 1.1131833333333334 0.8159166666666666l0.6614666666666668 0.3675c-0.45561666666666667 -1.5401583333333333 -0.6076166666666667 -3.1949833333333335 -0.6638000000000001 -4.610191666666667 -0.0024083333333333335 -0.060675 -0.005125 -0.12210000000000001 -0.007866666666666668 -0.18416666666666667l-0.001925 -0.04359166666666667c-0.5429083333333333 0.18853333333333333 -0.8477 0.32905 -1.0378333333333334 0.5928500000000001 -0.23595000000000002 0.3273666666666667 -0.23594166666666666 0.7622083333333334 -0.2359166666666667 1.6318833333333334Z" fill="currentColor" stroke-width="0.8333">
                        </path>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M13.647583333333333 1.9556166666666668C12.710916666666668 1.7975750000000001 11.486416666666667 1.6666666666666667 10.000166666666667 1.6666666666666667c-1.4863333333333335 0 -2.7108 0.13090833333333335 -3.6475166666666667 0.28895 -0.9489416666666667 0.16010833333333332 -1.4234166666666668 0.2401666666666667 -1.8198416666666666 0.7284083333333334 -0.3964333333333333 0.48825 -0.37548333333333334 1.0159583333333333 -0.33358333333333334 2.071366666666667C4.343075 8.378666666666666 5.124966666666667 12.90425 9.375 13.30475V16.25H8.183166666666668c-0.3972333333333333 0 -0.7392416666666667 0.2804166666666667 -0.81715 0.6699166666666666L7.208333333333334 17.708333333333336H5c-0.345175 0 -0.625 0.2798333333333333 -0.625 0.625s0.279825 0.625 0.625 0.625h10c0.3451666666666667 0 0.625 -0.2798333333333333 0.625 -0.625s-0.2798333333333333 -0.625 -0.625 -0.625h-2.2083333333333335l-0.15766666666666668 -0.7884166666666668c-0.07791666666666668 -0.3895 -0.4199166666666667 -0.6699166666666666 -0.8171666666666667 -0.6699166666666666H10.625v-2.94525c4.25025 -0.4003333333333333 5.032166666666667 -4.926 5.176 -8.549358333333334 0.041916666666666665 -1.0554083333333333 0.06291666666666666 -1.5831166666666667 -0.33358333333333334 -2.071366666666667 -0.3964166666666667 -0.4882416666666667 -0.8708333333333333 -0.5683 -1.8198333333333336 -0.7284083333333334ZM10.655833333333334 4.839258333333333c0.23358333333333334 0.09674166666666667 0.38583333333333336 0.3246416666666667 0.38583333333333336 0.5774250000000001V8.75c0 0.3451666666666667 -0.2798333333333333 0.625 -0.625 0.625s-0.625 -0.2798333333333333 -0.625 -0.625V6.925566666666667l-0.18308333333333335 0.18305833333333335c-0.24408333333333335 0.24408333333333335 -0.63975 0.24408333333333335 -0.8838333333333334 0 -0.24408333333333335 -0.244075 -0.24408333333333335 -0.6398083333333333 0 -0.8838833333333334l1.25 -1.25c0.17875 -0.17875 0.4475833333333334 -0.23221666666666668 0.6810833333333334 -0.13548333333333334Z" fill="currentColor" stroke-width="0.8333">
                        </path>
                      </svg>
                      {% if object.account_info.rank %}
                        Rank #{{ object.account_info.rank }}
                      {% else %}
                        Not ranked yet
                      {% endif %}
                    </span>
                    <span class="bg-byte-brown-500 text-white border border-byte-brown-200 text-xs px-2 py-1 rounded flex items-center gap-1">
                      <svg xmlns="http://www.w3.org/2000/svg"
                           width="12"
                           height="12"
                           fill="none"
                           viewBox="0 0 24 24"
                           stroke="currentColor"
                           stroke-width="2"
                           class="inline-block">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" />
                        <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                      </svg>
                      {{ object.solutions | length }} Heists Completed
                    </span>
                    <span class="bg-byte-brown-500 text-white border border-byte-brown-200 text-xs px-2 py-1 rounded flex items-center gap-1">
                      <svg viewBox="0 0 20 20"
                           fill="none"
                           xmlns="http://www.w3.org/2000/svg"
                           id="Medal-Ribbons-Star--Streamline-Solar"
                           height="16"
                           width="16">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M10 13.333333333333334c3.2216666666666667 0 5.833333333333334 -2.611666666666667 5.833333333333334 -5.833333333333334 0 -3.2216583333333335 -2.611666666666667 -5.833333333333334 -5.833333333333334 -5.833333333333334 -3.2216583333333335 0 -5.833333333333334 2.611675 -5.833333333333334 5.833333333333334 0 3.2216666666666667 2.611675 5.833333333333334 5.833333333333334 5.833333333333334Zm0 -8.333333333333334c-0.23675000000000002 0 -0.39508333333333334 0.2840333333333333 -0.71175 0.8520916666666667l-0.08191666666666667 0.14696666666666666c-0.08991666666666667 0.161425 -0.13491666666666666 0.24214166666666667 -0.20508333333333334 0.29539166666666666 -0.07016666666666667 0.05325833333333333 -0.1575 0.073025 -0.33225 0.11255833333333333l-0.15908333333333333 0.036000000000000004c-0.6149500000000001 0.13913333333333333 -0.9224083333333333 0.2087 -0.9955583333333333 0.443925 -0.07315 0.23522500000000002 0.13645000000000002 0.4803333333333334 0.5556666666666666 0.97055l0.10845833333333332 0.126825c0.119125 0.1393 0.17868333333333333 0.20895000000000002 0.20551666666666668 0.2951166666666667 0.02675 0.08615833333333334 0.017750000000000002 0.179075 -0.00025 0.36499166666666666l-0.016416666666666666 0.1691666666666667c-0.06336666666666667 0.6540833333333333 -0.09505 0.9810833333333334 0.09641666666666666 1.1265 0.19158333333333333 0.14533333333333334 0.4794166666666667 0.012833333333333334 1.0551666666666668 -0.25225000000000003l0.14891666666666667 -0.06858333333333333c0.16366666666666665 -0.07533333333333334 0.24541666666666667 -0.113 0.33216666666666667 -0.113 0.08675000000000001 0 0.1685 0.03766666666666667 0.33216666666666667 0.113l0.14891666666666667 0.06858333333333333c0.57575 0.26508333333333334 0.8635833333333334 0.39758333333333334 1.0551666666666668 0.25225000000000003 0.1915 -0.14541666666666667 0.15975 -0.47241666666666665 0.09641666666666666 -1.1265l-0.016416666666666666 -0.1691666666666667c-0.018000000000000002 -0.18591666666666667 -0.027 -0.2788333333333334 -0.00025 -0.36499166666666666 0.026833333333333334 -0.08616666666666667 0.08641666666666667 -0.1558166666666667 0.20550000000000002 -0.29510833333333336l0.10850000000000001 -0.12683333333333335c0.4191666666666667 -0.4902166666666667 0.6288333333333334 -0.735325 0.5556666666666666 -0.97055 -0.07316666666666667 -0.23522500000000002 -0.38066666666666665 -0.3047916666666667 -0.9955833333333335 -0.443925l-0.15908333333333333 -0.036000000000000004c-0.17475000000000002 -0.03953333333333334 -0.26208333333333333 -0.059300000000000005 -0.33225 -0.11255833333333333 -0.07016666666666667 -0.05325 -0.11516666666666667 -0.13396666666666665 -0.20508333333333334 -0.29539166666666666l-0.08191666666666667 -0.14696666666666666C10.395083333333334 5.284033333333333 10.23675 5 10 5Z" fill="currentColor" stroke-width="0.8333">
                        </path>
                        <path d="m3.745975 10.828416666666667 -1.2525916666666668 1.2970000000000002c-0.45010000000000006 0.466 -0.67515 0.6990000000000001 -0.753025 0.8963333333333333 -0.17745833333333333 0.44966666666666666 -0.02559166666666667 0.9485000000000001 0.3607916666666667 1.1850833333333333 0.16956666666666667 0.10375000000000001 0.4754083333333334 0.13608333333333333 1.0870916666666668 0.20083333333333334 0.34534166666666666 0.0365 0.51805 0.05475 0.662675 0.11016666666666668 0.32380000000000003 0.12416666666666666 0.575675 0.3849166666666667 0.6955416666666667 0.7201666666666666 0.05354166666666667 0.14975 0.07118333333333333 0.32858333333333334 0.10645833333333334 0.6861666666666667 0.06248333333333334 0.6333333333333334 0.093725 0.95 0.19398333333333334 1.1255833333333334 0.22845000000000001 0.40008333333333335 0.7102 0.5573333333333333 1.144491666666667 0.3735833333333333 0.19058333333333333 -0.08066666666666666 0.41563333333333335 -0.3136666666666667 0.8657333333333334 -0.7796666666666667l2.068375 -2.1415833333333336c-2.2479500000000003 -0.3421666666666667 -4.148625 -1.7408333333333335 -5.179525 -3.673666666666667Z" fill="currentColor" stroke-width="0.8333">
                        </path>
                        <path d="m11.0745 14.502083333333333 2.068416666666667 2.1415833333333336c0.4500833333333334 0.466 0.6750833333333334 0.6990000000000001 0.8656666666666667 0.7796666666666667 0.43433333333333335 0.18375 0.9160833333333334 0.026500000000000003 1.1445 -0.3735833333333333 0.10025 -0.17558333333333334 0.1315 -0.49225 0.194 -1.1255833333333334 0.03525 -0.3575833333333333 0.05291666666666667 -0.5364166666666668 0.10641666666666667 -0.6861666666666667 0.11991666666666667 -0.33525 0.37175 -0.596 0.6955833333333333 -0.7201666666666666 0.14466666666666667 -0.05541666666666667 0.31733333333333336 -0.07366666666666667 0.6626666666666667 -0.11016666666666668 0.6116666666666667 -0.06475 0.9175 -0.09708333333333334 1.0870833333333334 -0.20083333333333334 0.3864166666666667 -0.23658333333333334 0.53825 -0.7354166666666666 0.36083333333333334 -1.1850833333333333 -0.07791666666666668 -0.19733333333333336 -0.30291666666666667 -0.43033333333333335 -0.7530833333333333 -0.8963333333333333l-1.2525833333333334 -1.2970000000000002c-1.0309166666666667 1.9328333333333334 -2.9315833333333337 3.3315 -5.1795 3.673666666666667Z" fill="currentColor" stroke-width="0.8333">
                        </path>
                      </svg>
                      {% if object.account_info.first_places %}
                        {{ object.account_info.first_places }} First Places
                      {% else %}
                        Not Ranked Yet
                      {% endif %}
                    </span>
                  </div>
                  <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="text-center">
                      <div class="text-2xl font-bold text-byte-green-700">
                        {% if object.account_info.solutions %}
                          {{ object.account_info.solutions }}
                        {% else %}
                          0
                        {% endif %}
                      </div>
                      <div class="text-sm text-byte-brown-200">Solutions</div>
                    </div>
                    <div class="text-center">
                      <div class="text-2xl font-bold text-byte-green-700">{{ object.account_info.distinct_challenges }}</div>
                      <div class="text-sm text-byte-brown-200">Challenges</div>
                    </div>
                    <div class="text-center">
                      <div class="text-2xl font-bold text-byte-green-700">{{ object.account_info.first_places }}</div>
                      <div class="text-sm text-byte-brown-200">First Places</div>
                    </div>
                    <div class="text-center">
                      <div class="text-2xl font-bold text-byte-green-700">{{ object.account_info.top_ten_percents }}</div>
                      <div class="text-sm text-byte-brown-200">Top 10%</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Overview Tab Content -->
          <div class="mt-6">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <!-- Performance Stats -->
              <div class="border border-byte-brown-500 bg-byte-brown-700 rounded-lg">
                <div class="p-6">
                  <h3 class="text-white flex items-center gap-2 text-lg font-semibold mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         width="20"
                         height="20"
                         fill="none"
                         viewBox="0 0 24 24"
                         stroke="currentColor"
                         stroke-width="2"
                         class="text-green-500">
                      <path d="M22 12h-4l-3 9L9 3l-3 9H2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Performance Stats
                  </h3>
                  <div class="space-y-4">
                    <div class="space-y-2">
                      <div class="flex justify-between text-sm">
                        <span class="text-byte-brown-200">Average Solution Length [Not implemented]</span>
                        <span class="text-white">
                          {% if object.solutions and object.solutions | length > 0 %}
                            {{ object.solutions | length }} solutions
                          {% else %}
                            N/A
                          {% endif %}
                        </span>
                      </div>
                      <div class="w-full bg-byte-brown-500 rounded-full h-2">
                        <div class="bg-green-600 h-2 rounded-full" style="width: 75%"></div>
                      </div>
                    </div>
                    <div class="space-y-2">
                      <div class="flex justify-between text-sm">
                        <span class="text-byte-brown-200">Success Rate [Placeholder]</span>
                        <span class="text-white">87%</span>
                      </div>
                      <div class="w-full bg-byte-brown-500 rounded-full h-2">
                        <div class="bg-blue-600 h-2 rounded-full" style="width: 87%"></div>
                      </div>
                    </div>
                    <div class="space-y-2">
                      <div class="flex justify-between text-sm">
                        <span class="text-byte-brown-200">Speed (avg time to solve) [Placeholder]</span>
                        <span class="text-white">23 minutes</span>
                      </div>
                      <div class="w-full bg-byte-brown-500 rounded-full h-2">
                        <div class="bg-amber-600 h-2 rounded-full" style="width: 60%"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Recent Submissions -->
              <div class="border border-byte-brown-500 bg-byte-brown-700 rounded-lg lg:col-span-2">
                <div class="p-6">
                  <h3 class="text-white flex items-center gap-2 text-lg font-semibold mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         width="20"
                         height="20"
                         fill="none"
                         viewBox="0 0 24 24"
                         stroke="currentColor"
                         stroke-width="2"
                         class="text-green-500">
                      <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                      <path d="M21 12c-1 0-2-1-2-2s1-2 2-2 2 1 2 2-1 2-2 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                      <path d="M3 12c1 0 2-1 2-2s-1-2-2-2-2 1-2 2 1 2 2 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                      <path d="M12 3c0 1-1 2-2 2s-2-1-2-2 1-2 2-2 2 1 2 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                      <path d="M12 21c0-1 1-2 2-2s2 1 2 2-1 2-2 2-2-1-2-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Recent Submissions
                  </h3>
                  <div class="space-y-4">
                    {% set langs = languages() %}
                    {% for solution in object.solutions %}
                      {% if loop.index <= 5 %}
                        <div class="flex items-center justify-between p-4 rounded-lg bg-byte-brown-500 hover:bg-byte-brown-700 transition-colors">
                          <div class="flex items-center gap-4">
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            <div>
                              <div class="font-medium text-white">
                                <a href="/challenge/{{ solution.challenge_id }}/{{ solution.challenge_name | slugify }}/solve/{{ solution.language }}"
                                   class="hover:text-green-400 transition-colors">{{ solution.challenge_name }}</a>
                              </div>
                              <div class="text-sm text-byte-brown-200">
                                <img src="{%- if langs[solution.language] -%}/static/lang-icons/{{ langs[solution.language].icon }}{%- endif -%}"
                                     width="16"
                                     height="16"
                                     alt=""
                                     class="inline-block mr-1" />
                                {{ langs[solution.language].displayName }} â€¢ {{ solution.score }} characters
                              </div>
                            </div>
                          </div>
                          <div class="text-right">
                            <div class="text-sm font-medium text-green-400">Accepted</div>
                            <div class="text-xs text-byte-brown-200">2 hours ago</div>
                          </div>
                        </div>
                      {% endif %}
                    {% endfor %}
                    {% if not object.solutions %}
                      <div class="text-center py-8">
                        <div class="text-byte-brown-200">No submissions yet.</div>
                      </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Solutions Table (Original functionality) -->
          {% if object.solutions %}
            <div class="mt-8">
              <div class="border border-byte-brown-500 bg-byte-brown-700 rounded-lg">
                <div class="p-6">
                  <h3 class="text-white text-lg font-semibold mb-4">All Solutions</h3>
                  <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                      <thead>
                        <tr class="border-b border-byte-brown-500">
                          <th class="text-left py-3 px-4 text-byte-brown-200 font-medium">Challenge</th>
                          <th class="text-left py-3 px-4 text-byte-brown-200 font-medium">Language</th>
                          <th class="text-left py-3 px-4 text-byte-brown-200 font-medium">Score</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for solution in object.solutions %}
                          <tr class="border-b border-byte-brown-500 hover:bg-byte-brown-500 transition-colors">
                            <td class="py-3 px-4">
                              <a href="/challenge/{{ solution.challenge_id }}/{{ solution.challenge_name | slugify }}/solve/{{ solution.language }}"
                                 class="text-white hover:text-green-400 transition-colors">
                                {{ solution.challenge_name }}
                              </a>
                            </td>
                            <td class="py-3 px-4">
                              <a href="/challenge/{{ solution.challenge_id }}/{{ solution.challenge_name | slugify }}/solve/{{ solution.language }}"
                                 class="flex items-center gap-2 text-white hover:text-green-400 transition-colors">
                                <img src="{%- if langs[solution.language] -%}/static/lang-icons/{{ langs[solution.language].icon }}{%- endif -%}"
                                     width="24"
                                     height="24"
                                     alt=""
                                     class="lang-icon" />
                                {% if langs[solution.language] %}{{ langs[solution.language].displayName }}{% endif %}
                              </a>
                            </td>
                            <td class="py-3 px-4 text-white">{{ solution.score }}</td>
                          </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          {% endif %}
          <!-- Invalid Solutions (if user is viewing their own profile) -->
          {% if account and account.id == object.id and object.invalidated_solutions %}
            <div class="mt-8">
              <div class="border border-byte-brown-500 bg-byte-brown-700 rounded-lg">
                <div class="p-6">
                  <h3 class="text-white text-lg font-semibold mb-4">Invalid Solutions</h3>
                  <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                      <thead>
                        <tr class="border-b border-byte-brown-500">
                          <th class="text-left py-3 px-4 text-byte-brown-200 font-medium">Challenge</th>
                          <th class="text-left py-3 px-4 text-byte-brown-200 font-medium">Language</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for solution in object.invalidated_solutions %}
                          <tr class="border-b border-byte-brown-500 hover:bg-byte-brown-500 transition-colors">
                            <td class="py-3 px-4">
                              <a href="/challenge/{{ solution.challenge_id }}/{{ solution.challenge_name | slugify }}/solve/{{ solution.language }}"
                                 class="text-white hover:text-green-400 transition-colors">
                                {{ solution.challenge_name }}
                              </a>
                            </td>
                            <td class="py-3 px-4">
                              <a href="/challenge/{{ solution.challenge_id }}/{{ solution.challenge_name | slugify }}/solve/{{ solution.language }}"
                                 class="flex items-center gap-2 text-white hover:text-green-400 transition-colors">
                                <img src="/static/lang-icons/{{ langs[solution.language].icon }}"
                                     width="24"
                                     height="24"
                                     alt=""
                                     class="lang-icon" />
                                {{ langs[solution.language].displayName }}
                              </a>
                            </td>
                          </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </main>
{% endblock content %}
